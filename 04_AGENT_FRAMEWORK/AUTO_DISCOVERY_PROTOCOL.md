# üîç Automatic Central Intelligence Discovery Protocol
## How Agents Find the MCP Server Automatically - ZERO CONFIGURATION

**Date**: 2025-10-09
**Concept**: AUTOMATIC MCP SERVER DISCOVERY
**Status**: DESIGN COMPLETE - READY TO IMPLEMENT

---

## üéØ THE VISION

### **CURRENT (Manual Configuration):**
```typescript
// Agent must know where MCP server is
const client = new TaskRegistryClient('A', {
  serverPath: '/Users/lech/PROJECTS_all/LocalBrain/01_CODEBASES/mcp-servers/...'
});
```

### **TARGET (Automatic Discovery):**
```typescript
// Agent just connects - system finds MCP automatically!
const client = await BrainClient.autoConnect();
// ‚Üí Discovers MCP server automatically
// ‚Üí Connects
// ‚Üí Ready to work!

// Or via CLI:
$ brain connect
// ‚Üí No configuration needed
// ‚Üí Finds MCP server automatically
// ‚Üí Just works!
```

---

## üîç DISCOVERY METHODS (5 Strategies)

### **Method 1: Git Repository Detection** ‚≠ê PRIMARY

**Concept**: Climb directory tree looking for `.brain/server` marker

```typescript
class MCPDiscovery {
  /**
   * Find MCP server by climbing git repository
   */
  async discoverViaGitRepo(): Promise<string | null> {
    let currentDir = process.cwd();

    while (currentDir !== '/') {
      // Check for .brain/server marker
      const markerPath = path.join(currentDir, '.brain', 'server.json');

      if (existsSync(markerPath)) {
        const config = JSON.parse(readFileSync(markerPath, 'utf-8'));

        return path.resolve(currentDir, config.serverPath);
      }

      // Check if this is git repository root
      if (existsSync(path.join(currentDir, '.git'))) {
        // Check for MCP server in standard locations
        const standardPaths = [
          '01_CODEBASES/mcp-servers/*/dist/index.js',
          'mcp-server/dist/index.js',
          '.brain/mcp-server/dist/index.js'
        ];

        for (const pattern of standardPaths) {
          const matches = glob.sync(pattern, { cwd: currentDir });
          if (matches.length > 0) {
            return path.join(currentDir, matches[0]);
          }
        }
      }

      // Go up one directory
      const parentDir = path.dirname(currentDir);
      if (parentDir === currentDir) break; // Reached root
      currentDir = parentDir;
    }

    return null;
  }
}
```

**Usage:**
```bash
# In any project directory
cd /Users/lech/PROJECTS_all/LocalBrain/01_CODEBASES/backend/rag
$ brain connect

# System automatically:
1. Climbs to repo root: /Users/lech/PROJECTS_all/LocalBrain
2. Finds: .brain/server.json (or scans for mcp-server)
3. Discovers: 01_CODEBASES/mcp-servers/localbrain-task-registry/dist/index.js
4. Connects automatically!

Manual configuration: ZERO
```

### **Method 2: Network Discovery (mDNS/Bonjour)** ‚≠ê CLOUD

**Concept**: MCP server broadcasts its presence on local network

```typescript
// MCP Server broadcasts:
import bonjour from 'bonjour';

const bonjourInstance = bonjour();

// Advertise MCP server
bonjourInstance.publish({
  name: 'Central Intelligence MCP',
  type: 'brain-mcp',
  port: 3000,
  txt: {
    version: '2.0.0',
    projects: 'LocalBrain,AudioAnalyzer',
    tools: '18'
  }
});

console.log('üì° Broadcasting Central Intelligence on local network');

// Client discovers:
class MCPDiscovery {
  async discoverViaNetwork(): Promise<string[]> {
    return new Promise((resolve) => {
      const servers: string[] = [];

      const browser = bonjourInstance.find({ type: 'brain-mcp' });

      browser.on('up', (service) => {
        const url = `ws://${service.host}:${service.port}`;
        servers.push(url);
        console.log(`üì° Found Central Intelligence: ${url}`);
      });

      setTimeout(() => {
        browser.stop();
        resolve(servers);
      }, 3000); // Scan for 3 seconds
    });
  }
}
```

**Usage:**
```bash
$ brain connect

Scanning for Central Intelligence...
üì° Found: Central Intelligence MCP at ws://localhost:3000
üì° Found: Central Intelligence MCP at ws://192.168.1.100:3000 (office)
üì° Found: Central Intelligence MCP at ws://brain.company.com:3000 (cloud)

Which server? ‚Üí localhost (default)
‚úÖ Connected!
```

**Benefits:**
- Works across machines on same network
- Discovers cloud instances
- Zero configuration
- Multiple servers supported

---

### **Method 3: Global Registry File** ‚≠ê SIMPLE

**Concept**: Shared file in home directory lists all MCP servers

```bash
# ~/.brain/registry.json (automatically maintained)
{
  "servers": [
    {
      "id": "localbrain-local",
      "name": "LocalBrain (Local)",
      "type": "stdio",
      "path": "/Users/lech/PROJECTS_all/LocalBrain/01_CODEBASES/mcp-servers/localbrain-task-registry/dist/index.js",
      "projects": ["LocalBrain"],
      "active": true,
      "lastSeen": "2025-10-09T02:00:00Z"
    },
    {
      "id": "central-cloud",
      "name": "Central Intelligence (Cloud)",
      "type": "websocket",
      "url": "wss://brain.railway.app/mcp",
      "projects": ["*"], // All projects
      "active": true,
      "lastSeen": "2025-10-09T02:00:00Z"
    },
    {
      "id": "audio-analyzer-local",
      "name": "AudioAnalyzer (Local)",
      "type": "stdio",
      "path": "/Users/lech/PROJECTS_all/AudioAnalyzer/mcp-server/dist/index.js",
      "projects": ["AudioAnalyzer"],
      "active": false
    }
  ],
  "preferences": {
    "preferLocal": true,
    "fallbackToCloud": true
  }
}
```

**Auto-Discovery Logic:**
```typescript
class MCPDiscovery {
  async discoverFromRegistry(): Promise<MCPServer | null> {
    const registryPath = path.join(os.homedir(), '.brain', 'registry.json');

    if (!existsSync(registryPath)) {
      return null;
    }

    const registry = JSON.parse(readFileSync(registryPath, 'utf-8'));

    // Current project detection
    const currentProject = await this.detectCurrentProject();

    // Find servers for this project
    const candidates = registry.servers.filter(s =>
      s.active &&
      (s.projects.includes('*') || s.projects.includes(currentProject))
    );

    // Prefer local, fallback to cloud
    const local = candidates.find(s => s.type === 'stdio');
    if (local && registry.preferences.preferLocal) {
      return local;
    }

    const cloud = candidates.find(s => s.type === 'websocket');
    if (cloud && registry.preferences.fallbackToCloud) {
      return cloud;
    }

    return candidates[0] || null;
  }
}
```

**Usage:**
```bash
$ brain connect

üîç Discovering Central Intelligence...
   ‚Üí Checking ~/.brain/registry.json
   ‚Üí Found 3 registered servers
   ‚Üí Current project: LocalBrain
   ‚Üí Matching servers: 2 (local + cloud)
   ‚Üí Preference: Local first
   ‚úÖ Using: LocalBrain (Local)
   ‚úÖ Connected in 2 seconds!

Manual configuration: ZERO
Fallback to cloud: AUTOMATIC
```

**Registry Auto-Updated:**
```typescript
// When MCP server starts, it registers itself:
const registryPath = path.join(os.homedir(), '.brain', 'registry.json');
const registry = loadRegistry(registryPath);

registry.servers.push({
  id: 'localbrain-local',
  name: 'LocalBrain (Local)',
  path: __filename,
  projects: ['LocalBrain'],
  active: true,
  lastSeen: new Date().toISOString()
});

saveRegistry(registryPath, registry);
console.log('üìù Registered in ~/.brain/registry.json');
```

---

### **Method 4: Environment Variable Discovery**

**Concept**: Check standard environment variables

```typescript
class MCPDiscovery {
  async discoverViaEnvironment(): Promise<string | null> {
    // Check multiple env vars
    const candidates = [
      process.env.BRAIN_MCP_SERVER,        // Explicit
      process.env.MCP_SERVER_PATH,         // Generic MCP
      process.env.BRAIN_SERVER_PATH,       // Our naming
      process.env.LOCALBRAIN_MCP_SERVER    // Project-specific
    ];

    for (const path of candidates) {
      if (path && existsSync(path)) {
        return path;
      }
    }

    // Check if URL (cloud)
    const urls = [
      process.env.BRAIN_MCP_URL,
      process.env.MCP_SERVER_URL
    ];

    for (const url of urls) {
      if (url && url.startsWith('ws://') || url.startsWith('wss://')) {
        return url;
      }
    }

    return null;
  }
}
```

**Configuration:**
```bash
# In ~/.zshrc or ~/.bashrc
export BRAIN_MCP_SERVER="/Users/lech/PROJECTS_all/LocalBrain/01_CODEBASES/mcp-servers/localbrain-task-registry/dist/index.js"

# Or for cloud
export BRAIN_MCP_URL="wss://brain.railway.app/mcp"

# Now brain connect works from ANY directory!
```

---

### **Method 5: DNS-SD Service Discovery** (Enterprise)

**Concept**: MCP server registers with DNS-SD (like Bonjour but DNS-based)

```typescript
// MCP Server registers via DNS-SD
import dnssd from 'dnssd';

const service = dnssd.register({
  name: 'Central Intelligence',
  type: 'brain-mcp',
  port: 3000,
  txt: {
    version: '2.0.0',
    projects: '*',
    health: 'healthy'
  }
});

// Client discovers via DNS
class MCPDiscovery {
  async discoverViaDNS(): Promise<string[]> {
    const browser = dnssd.browse('brain-mcp');
    const servers: string[] = [];

    return new Promise((resolve) => {
      browser.on('serviceUp', (service) => {
        servers.push(`${service.host}:${service.port}`);
      });

      setTimeout(() => {
        browser.stop();
        resolve(servers);
      }, 5000);
    });
  }
}
```

**Usage:**
```bash
$ brain connect

üîç Discovering Central Intelligence via DNS-SD...
   Found:
   1. brain-local.local:3000 (Local)
   2. brain-office.local:3000 (Office)
   3. brain-cloud.company.com:443 (Cloud)

Which? ‚Üí 1 (auto-select local)
‚úÖ Connected!
```

---

## üåü THE ULTIMATE AUTO-DISCOVERY (All Methods Combined)

### **Waterfall Discovery Strategy:**

```typescript
class BrainClient {
  /**
   * Auto-discover and connect (tries all methods)
   */
  async autoConnect(): Promise<BrainClient> {
    console.log('üîç Auto-discovering Central Intelligence...');

    // Method 1: Check environment variables (fastest)
    let server = await this.discoverViaEnvironment();
    if (server) {
      console.log('‚úÖ Found via environment variable');
      return await this.connect(server);
    }

    // Method 2: Check global registry (fast)
    server = await this.discoverFromRegistry();
    if (server) {
      console.log('‚úÖ Found via ~/.brain/registry.json');
      return await this.connect(server);
    }

    // Method 3: Climb git repository (medium)
    server = await this.discoverViaGitRepo();
    if (server) {
      console.log('‚úÖ Found via git repository scan');
      return await this.connect(server);
    }

    // Method 4: Network discovery (slower)
    const networkServers = await this.discoverViaNetwork();
    if (networkServers.length > 0) {
      console.log(`‚úÖ Found ${networkServers.length} server(s) on network`);

      // Prefer local network over cloud
      server = this.selectBestServer(networkServers);
      return await this.connect(server);
    }

    // Method 5: Cloud fallback (official server)
    server = 'wss://brain.official.com/mcp';
    console.log('üì° Falling back to official cloud server');
    return await this.connect(server);

    // If all fail:
    throw new Error('‚ùå Could not discover Central Intelligence. Please configure manually.');
  }
}
```

**Usage:**
```bash
$ brain connect

üîç Auto-discovering Central Intelligence...
   ‚Üí Checking environment... not found
   ‚Üí Checking registry... not found
   ‚Üí Scanning git repo... ‚úÖ FOUND!
   ‚Üí Path: 01_CODEBASES/mcp-servers/localbrain-task-registry/dist/index.js
‚úÖ Connected in 3 seconds!

Manual configuration: ZERO
Just works: YES ‚úÖ
```

---

## üèóÔ∏è MULTI-LEVEL DISCOVERY ARCHITECTURE

### **Level 1: Project-Local MCP (Highest Priority)**

```
Agent working in: /Users/lech/PROJECTS_all/LocalBrain/01_CODEBASES/ui/

Discovery:
1. Check: ./CLAUDE.md for mcp_server_path
2. Check: ./.brain/server.json
3. Climb to git root: /Users/lech/PROJECTS_all/LocalBrain
4. Scan: 01_CODEBASES/mcp-servers/*/dist/index.js
5. FOUND: localbrain-task-registry/dist/index.js
6. Connect: LOCAL

Why:
‚úÖ Fastest (local process)
‚úÖ Project-specific
‚úÖ Full context available
‚úÖ Offline capable
```

### **Level 2: Shared MCP Server (Medium Priority)**

```
Agent working in: /Users/lech/PROJECTS_all/AudioAnalyzer/

Discovery:
1. No local MCP found in AudioAnalyzer
2. Check: ~/.brain/registry.json
3. Found: 3 registered servers
   ‚îú‚îÄ LocalBrain MCP (projects: LocalBrain)
   ‚îú‚îÄ Universal MCP (projects: *)  ‚Üê MATCHES!
   ‚îî‚îÄ AudioAnalyzer MCP (not running)
4. Connect: Universal MCP

Why:
‚úÖ Shared across projects
‚úÖ One server for all
‚úÖ Centralized coordination
‚úÖ Still local (fast)
```

### **Level 3: Cloud MCP (Fallback)**

```
Agent on new machine (no local MCP):

Discovery:
1. No local server found
2. Check: Network broadcast (mDNS)
3. Not found (different network)
4. Fallback: Cloud server
   ‚Üí wss://brain.railway.app/mcp
5. Connect: CLOUD

Why:
‚úÖ Works from anywhere
‚úÖ No local installation needed
‚úÖ Cross-machine coordination
‚úÖ Always available
```

---

## üìÅ PROJECT STRUCTURE WITH AUTO-DISCOVERY

### **Option A: Marker File (Explicit)**

```
/Users/lech/PROJECTS_all/LocalBrain/
‚îú‚îÄ‚îÄ .brain/
‚îÇ   ‚îî‚îÄ‚îÄ server.json          ‚Üê DISCOVERY MARKER
‚îÇ       {
‚îÇ         "serverPath": "01_CODEBASES/mcp-servers/localbrain-task-registry/dist/index.js",
‚îÇ         "serverType": "stdio",
‚îÇ         "autoStart": true,
‚îÇ         "projects": ["LocalBrain"]
‚îÇ       }
‚îú‚îÄ‚îÄ 01_CODEBASES/
‚îÇ   ‚îî‚îÄ‚îÄ mcp-servers/
‚îÇ       ‚îî‚îÄ‚îÄ localbrain-task-registry/  ‚Üê ACTUAL SERVER
‚îî‚îÄ‚îÄ ... rest of project
```

**Agent anywhere in project:**
```bash
cd LocalBrain/01_CODEBASES/ui/components/
$ brain connect

Discovery:
‚Üí Climbs to root
‚Üí Finds .brain/server.json
‚Üí Reads serverPath
‚Üí Connects to ../01_CODEBASES/mcp-servers/.../index.js
‚úÖ Connected!
```

### **Option B: Convention (Implicit)**

```
/Users/lech/PROJECTS_all/LocalBrain/
‚îú‚îÄ‚îÄ 01_CODEBASES/
‚îÇ   ‚îî‚îÄ‚îÄ mcp-servers/
‚îÇ       ‚îî‚îÄ‚îÄ */dist/index.js   ‚Üê CONVENTION: Scan for this pattern
‚îî‚îÄ‚îÄ ... rest of project
```

**Discovery scans for standard patterns:**
```typescript
const patterns = [
  '01_CODEBASES/mcp-servers/*/dist/index.js',  // Lech's convention
  'mcp-server/dist/index.js',                  // Simple convention
  '.brain/mcp/dist/index.js',                  // Hidden convention
  'server/mcp/dist/index.js'                   // Alternative
];
```

**No marker file needed!**
**Works via convention!**

---

## üåê UNIVERSAL MCP SERVER (One Server, All Projects)

### **Concept**: Single MCP server in PROJECTS_all/ root

```
/Users/lech/PROJECTS_all/
‚îú‚îÄ‚îÄ .brain/
‚îÇ   ‚îî‚îÄ‚îÄ universal-mcp-server/      ‚Üê ONE SERVER FOR ALL
‚îÇ       ‚îú‚îÄ‚îÄ dist/index.js
‚îÇ       ‚îî‚îÄ‚îÄ data/
‚îÇ           ‚îî‚îÄ‚îÄ registry.db        ‚Üê ALL projects in one DB
‚îú‚îÄ‚îÄ LocalBrain/
‚îú‚îÄ‚îÄ AudioAnalyzer/
‚îú‚îÄ‚îÄ Gov.br/
‚îî‚îÄ‚îÄ ... 57 more projects

All 60 projects use SAME MCP server!
```

**Auto-Discovery:**
```typescript
class MCPDiscovery {
  async discoverUniversalMCP(): Promise<string | null> {
    // Check if we're inside PROJECTS_all/
    let dir = process.cwd();

    while (dir !== '/') {
      if (path.basename(dir) === 'PROJECTS_all') {
        // Found PROJECTS_all root!
        const universalMCP = path.join(dir, '.brain/universal-mcp-server/dist/index.js');

        if (existsSync(universalMCP)) {
          return universalMCP;
        }
      }

      dir = path.dirname(dir);
    }

    return null;
  }
}
```

**Usage - Works from ANY project:**
```bash
cd /Users/lech/PROJECTS_all/LocalBrain
$ brain connect
‚Üí Found: /Users/lech/PROJECTS_all/.brain/universal-mcp-server
‚Üí Project: LocalBrain

cd /Users/lech/PROJECTS_all/AudioAnalyzer
$ brain connect
‚Üí Found: /Users/lech/PROJECTS_all/.brain/universal-mcp-server (SAME!)
‚Üí Project: AudioAnalyzer (different project, same server!)

cd /Users/lech/PROJECTS_all/Gov.br
$ brain connect
‚Üí Found: /Users/lech/PROJECTS_all/.brain/universal-mcp-server (SAME!)
‚Üí Project: Gov.br (different project again!)

ALL use ONE server!
Multi-project coordination automatic!
```

---

## üîß AUTO-START MECHANISMS

### **Method 1: On-Demand Start (Lazy)**

```typescript
class BrainClient {
  async autoConnect() {
    const serverPath = await MCPDiscovery.discover();

    // Check if server is running
    const isRunning = await this.checkServerRunning(serverPath);

    if (!isRunning) {
      console.log('üöÄ Starting MCP server...');

      // Auto-start server in background
      const server = spawn('node', [serverPath], {
        detached: true,
        stdio: 'ignore'
      });

      server.unref(); // Don't wait for it

      // Wait for it to be ready
      await this.waitForServer(3000);

      console.log('‚úÖ MCP server started');
    }

    // Connect
    return await this.connect(serverPath);
  }
}
```

**Result:**
```bash
$ brain connect

üîç Discovering MCP server...
‚úÖ Found at: 01_CODEBASES/mcp-servers/.../index.js
‚ö†Ô∏è  Server not running
üöÄ Starting server automatically...
‚úÖ Server started in 2 seconds
‚úÖ Connected!

Manual start: NOT NEEDED
Auto-start: YES ‚úÖ
```

### **Method 2: Persistent Daemon (Always Running)**

```bash
# Install as system service (macOS)
$ brain install-daemon

Creates:
~/Library/LaunchAgents/com.brain.mcp.plist
‚Üí Starts on login
‚Üí Restarts on crash
‚Üí Runs in background
‚Üí Always available

# Install as systemd service (Linux)
$ brain install-daemon

Creates:
~/.config/systemd/user/brain-mcp.service
‚Üí Starts on boot
‚Üí Restarts on crash
‚Üí Runs in background

# Now:
$ brain connect
‚Üí Server always running
‚Üí Connects in <1 second
‚Üí Zero startup time
```

---

## üéØ MULTI-PROJECT AUTO-DISCOVERY STRATEGY

### **Scenario: Developer Works on 5 Projects**

```
/Users/lech/PROJECTS_all/
‚îú‚îÄ‚îÄ LocalBrain/          (has local MCP)
‚îú‚îÄ‚îÄ AudioAnalyzer/       (no MCP)
‚îú‚îÄ‚îÄ Gov.br/              (no MCP)
‚îú‚îÄ‚îÄ ProfilePro/          (has local MCP)
‚îî‚îÄ‚îÄ PROJECT_minerals/    (no MCP)

Auto-Discovery Strategy:

LocalBrain:
$ brain connect
‚Üí Finds: LocalBrain/01_CODEBASES/mcp-servers/.../index.js
‚Üí Uses: LOCAL server
‚Üí Fast, project-specific

AudioAnalyzer:
$ brain connect
‚Üí No local MCP found
‚Üí Checks: ~/.brain/registry.json
‚Üí Finds: Universal MCP (projects: *)
‚Üí Uses: SHARED server
‚Üí Still fast, multi-project

ProfilePro:
$ brain connect
‚Üí Finds: ProfilePro local MCP
‚Üí Uses: LOCAL server
‚Üí Project-specific

Gov.br:
$ brain connect
‚Üí No local MCP
‚Üí Uses: Universal MCP (same as AudioAnalyzer)
‚Üí Shared coordination

ALL AUTOMATIC!
ZERO CONFIGURATION PER PROJECT!
```

---

## üöÄ IMPLEMENTATION PRIORITY

### **Quick Wins (Implement First - 4 hours):**

**1. Git Repository Discovery** (2 hours)
```typescript
Implement:
‚îú‚îÄ Climb directory tree
‚îú‚îÄ Check .brain/server.json
‚îú‚îÄ Scan for mcp-server pattern
‚îî‚îÄ Auto-connect

Impact: HIGH (works for Lech's projects)
Effort: LOW
Benefit: Immediate
```

**2. Global Registry** (1 hour)
```typescript
Implement:
‚îú‚îÄ ~/.brain/registry.json format
‚îú‚îÄ Auto-register on server start
‚îú‚îÄ Lookup by project
‚îî‚îÄ Fallback logic

Impact: MEDIUM (cross-project)
Effort: LOW
Benefit: Multi-project support
```

**3. Auto-Start Server** (1 hour)
```typescript
Implement:
‚îú‚îÄ Check if running
‚îú‚îÄ Auto-start if not
‚îú‚îÄ Wait for ready
‚îî‚îÄ Connect

Impact: HIGH (zero manual start)
Effort: LOW
Benefit: Seamless UX
```

### **Future Enhancements (20 hours):**

**4. Network Discovery (mDNS)** (4 hours)
- Broadcast on local network
- Cross-machine discovery
- Office network coordination

**5. LaunchAgent/systemd** (2 hours)
- System service installation
- Always-running daemon
- Survives reboots

**6. Cloud Fallback** (8 hours)
- Official cloud instance
- Works from anywhere
- No local installation

**7. Smart Selection** (6 hours)
- Performance-based selection
- Health-based selection
- Automatic failover

---

## üìä BEFORE vs AFTER AUTO-DISCOVERY

### **BEFORE (Manual):**
```
Agent must know:
‚ùå Where is MCP server?
‚ùå What's the exact path?
‚ùå Is it running?
‚ùå How to start it?
‚ùå What port? What transport?

Setup time: 10-15 minutes first time
Setup time: 2-3 minutes each session
Friction: HIGH
Errors: Common
```

### **AFTER (Auto-Discovery):**
```
Agent just runs:
$ brain connect

System automatically:
‚úÖ Finds MCP server (5 methods)
‚úÖ Starts if needed
‚úÖ Connects
‚úÖ Ready

Setup time: 0 seconds
Friction: ZERO
Errors: Rare
Just works: YES ‚úÖ
```

---

## üéØ IMPLEMENTATION ROADMAP

### **Phase 1: Local Discovery (4 hours)**
```
T031: Implement Git Repo Discovery
  ‚îú‚îÄ Climb directory tree
  ‚îú‚îÄ Check marker files
  ‚îî‚îÄ Scan patterns

T032: Implement Global Registry
  ‚îú‚îÄ ~/.brain/registry.json
  ‚îú‚îÄ Auto-registration
  ‚îî‚îÄ Lookup logic

T033: Implement Auto-Start
  ‚îú‚îÄ Check if running
  ‚îú‚îÄ Start if needed
  ‚îî‚îÄ Wait for ready

Result: brain connect works from ANY directory in project
```

### **Phase 2: Network Discovery (4 hours)**
```
T034: Implement mDNS/Bonjour
  ‚îú‚îÄ Server broadcasts
  ‚îú‚îÄ Client scans
  ‚îî‚îÄ Multi-server support

Result: brain connect works across machines on same network
```

### **Phase 3: Cloud Integration (8 hours)**
```
T035: Deploy to Railway
T036: DNS-SD registration
T037: Smart fallback logic

Result: brain connect works from ANYWHERE
```

---

## üí° THE ULTIMATE DEVELOPER EXPERIENCE

### **What It Looks Like:**

```bash
# New machine, never used brain before
$ npm install -g @lech/brain-cli

# First time in ANY project
$ cd ~/projects/LocalBrain
$ brain connect

üîç Auto-discovering Central Intelligence...
   ‚Üí Scanning repository... ‚úÖ Found!
   ‚Üí Starting MCP server...
   ‚Üí Connecting...
   ‚úÖ Connected as new agent

üéØ Welcome! I'm Central Intelligence.
   Let me help you get started:

   Project: LocalBrain (COMMERCIAL_APP)
   Context: 1,808 files (auto-extracted)
   Your role: Integration Specialist (auto-assigned)

   üìã Recommended starter tasks:
   1. T002: IPC Schema (90% match - good first task)
   2. T008: Swift Bridge (85% match)

   Claim T002? ‚Üí y

‚úÖ Task claimed!
üìö Context loaded (23 relevant files)
üöÄ Start coding!

[3 hours later]

# Task done
$ brain task complete

‚úÖ Verified! Unlocked T013
üéâ Great first contribution!
üí° Try T013 next?

TIME TO PRODUCTIVITY: 5 minutes
CONFIGURATION: ZERO
FRICTION: NONE
```

---

## üéØ ANSWER TO YOUR QUESTION

**"Do we develop ways to make Central Intelligence automatically found by agents?"**

### **YES! HERE'S HOW:**

**5 Auto-Discovery Methods:**
1. ‚úÖ **Git Repository Scan** - Climb tree, find MCP server
2. ‚úÖ **Global Registry** - ~/.brain/registry.json
3. ‚úÖ **Environment Variables** - Standard env vars
4. ‚úÖ **Network Broadcast** - mDNS/Bonjour discovery
5. ‚úÖ **Cloud Fallback** - Official cloud instance

**Implementation:**
- Quick wins: 4 hours (Git + Registry + Auto-Start)
- Full system: 16 hours (all 5 methods)

**Result:**
```bash
$ brain connect  # From ANYWHERE
‚Üí Auto-discovers MCP
‚Üí Auto-starts if needed
‚Üí Auto-connects
‚Üí Just works

Configuration: ZERO
Manual steps: ZERO
Seamlessness: 10/10 ‚úÖ
```

**This makes Central Intelligence truly seamless - agents just connect, system figures out the rest!** üéØ

---

**Created By**: Agent D
**Concept**: Auto-Discovery Protocol
**Status**: DESIGNED - Ready to implement
**Impact**: TRUE ZERO-CONFIG EXPERIENCE
**Priority**: HIGH (makes system actually usable!)
